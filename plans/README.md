# Plans Directory

This directory contains conductor-generated artifacts for all orchestrated workflows. Each plan follows the lifecycle: Planning → Implementation (per phase) → Review → Completion.

## Directory Structure

```
plans/
├── samples/                          # Example artifacts (reference implementations)
│   ├── example-feature-implementation.md
│   ├── example-phase-complete.md
│   └── example-plan-complete.md
├── {task-name}.md                    # Initial plan (from planner agent)
├── {task-name}-phase-1.md           # Phase 1 completion (from implementer)
├── {task-name}-phase-2.md           # Phase 2 completion
├── {task-name}-phase-N.md           # Phase N completion
└── {task-name}-complete.md          # Final summary (from conductor)
```

## Artifact Types

### Plan (`{task-name}.md`)
Generated by the **Planner** agent at the start of each workflow.

**Contents:**
- TL;DR summary
- Numbered phases with objectives, files, tests, steps
- Open questions requiring user input
- Risks and mitigations
- Compliance checkpoints

**Template:** `docs/templates/plan.md`

### Phase Completion (`{task-name}-phase-N.md`)
Generated by the **Implementer** agent after each phase execution.

**Contents:**
- Changes summary (new files, modifications)
- Test results (unit, integration, validation)
- Diff overview with rationale
- Validation evidence (linting, coverage, database checks)
- Residual risks and follow-up tasks

**Template:** `docs/templates/phase-complete.md`

### Plan Completion (`{task-name}-complete.md`)
Generated by the **Conductor** agent when all phases finish.

**Contents:**
- Executive summary
- Phase completion summary table
- Deliverables (code, docs, infrastructure)
- Test results summary
- Security/performance review outcomes
- Open questions resolution
- Deployment summary
- Follow-up tasks
- Lessons learned
- Metrics and achievements

**Template:** `docs/templates/plan-complete.md`

## Naming Conventions

Use lowercase with hyphens for task names:
- ✅ `add-user-authentication.md`
- ✅ `refactor-payment-processing-phase-2.md`
- ✅ `fix-memory-leak-complete.md`
- ❌ `AddUserAuth.md` (avoid camelCase)
- ❌ `task_123.md` (avoid underscores and issue numbers)

## Lifecycle Example

```
User: "Add OAuth authentication to the API"
    ↓
Conductor invokes Planner
    ↓
plans/add-oauth-authentication.md created
[PAUSE for approval]
    ↓
Conductor invokes Implementer (Phase 1)
    ↓
plans/add-oauth-authentication-phase-1.md created
    ↓
Conductor invokes Reviewer
[PAUSE for commit approval]
    ↓
Repeat for phases 2-N
    ↓
Conductor generates completion report
    ↓
plans/add-oauth-authentication-complete.md created
[END]
```

## Auditability & Resumability

**Benefits:**
- Full history of decisions, changes, and validations
- Resume interrupted work by reviewing last phase artifact
- Transfer knowledge to new contributors
- Post-mortem analysis for retrospectives
- Compliance audit trail

**Retention:**
- Keep artifacts for active/recent projects in root `plans/` directory
- Archive completed projects to `plans/archive/` quarterly
- Link to artifacts in PR descriptions for context

## Usage Tips

### Starting a New Plan
1. Invoke conductor with task description
2. Conductor calls planner subagent
3. Review generated `{task-name}.md`
4. Approve or request revisions
5. Conductor proceeds to implementation

### Resuming Interrupted Work
1. Open the latest phase completion artifact
2. Review "Follow-Up Tasks" and "Residual Risks"
3. Tell conductor: "Resume from Phase N"
4. Conductor picks up where left off

### Searching Past Work
```bash
# Find all authentication-related plans
grep -r "authentication" plans/*.md

# List all incomplete plans (no -complete.md)
ls plans/*.md | grep -v "phase" | grep -v "complete"

# Find plans with security reviews
grep -r "Security Review" plans/*complete.md
```

## Sample Artifacts

The `samples/` directory contains three reference implementations:

1. **`example-feature-implementation.md`**
   - Multi-phase plan for OAuth authentication
   - Shows proper phase structure, test strategy, risk documentation

2. **`example-phase-complete.md`**
   - Phase 1 completion for database schema
   - Demonstrates test results, diff summary, validation evidence

3. **`example-plan-complete.md`**
   - Final summary for completed authentication project
   - Shows comprehensive reporting, metrics, lessons learned

**Usage:** Reference these samples when creating new plans or reviewing conductor output.

## Gitignore Behavior

By default, the `plans/` directory is gitignored to prevent cluttering the repository. However, you may:

- **Commit specific plans** when they serve as documentation (force add: `git add -f plans/{task}.md`)
- **Archive important projects** by moving to `plans/archive/` and committing
- **Link in PRs** by uploading artifacts as GitHub PR comments

Adjust `.gitignore` if your team prefers committing all plans.

## Validation

Plans are **not validated** by `scripts/validate-copilot-assets.ps1` since they are auto-generated. However:

- Use templates from `docs/templates/` for consistency
- Run markdown linting if committing plans: `markdownlint plans/*.md`
- Review conductor-generated artifacts for completeness

## Support

- **Questions:** Post in repository issues or `docs/operations.md` backlog
- **Template Updates:** Submit PRs to `docs/templates/`
- **Sample Contributions:** Add new examples to `plans/samples/` with descriptive names
